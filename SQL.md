





### 2、检索数据




### 3、排序检索数据

如果不排序，数据一般将以它在底层表中出现的顺序显示；

SQL语句由子句构成，有些子句是必需的，有些则是可选的；

#### ORDER BY

- 为了明确的排序用SELECT语句检索出的数据，可使用 ORDER BY子句，ORDER BY子句取一个或多个列的名字，据此对输出进行排序，默认是按照字母顺序排序；
- ORDER BY子句应保证 它是SELECT语句中 最后一条 子句，不然会出现错误信息；
- ORDER BY 子句中使用的列可以是为显示而选择的列，也可以是非检索的列；
- ORDER BY可以按照多个列排序，简单指定列名，列名之间用逗号隔开即可；这里的列名可以用SELECT中列的相对位置的序号来代替（从1开始），所以如果用的是序号，就不能是非检索的列；
- ORDER BY默认的排序方向是A-Z的方向，可以在列名后面添加关键字DESC（也可以用DESCENDING）来修改为Z-A的排序方向；DESC只对其前方的一个列起作用，如果是多列排序，就需要用多个DESC关键字；



### 4、过滤数据


#### WHERE

- WHERE必须放置在表名（FROM子句）之后，ORDER BY子句之前，不然会出错；
- WHERE子句的操作符
- 单引号用来限定字符串，如果将值与字符串类型的列相比较，就需要限定引号，用来与数值列相比较的值不需要引号；
- 在使用BERWEEN操作符时，必须指定两个值，一个低端值和一个高端值，中间用AND关键字分隔；
- 在一个列不包含值时，称其包含空值NULL，它与字段包含0、空字符串或仅仅包含空格不同，可以利用子句IS NULL来检查具有NULL值的列；通过过滤选择不包含指定值的 所有行时，含NULL值的行不会返回；

### 5、高级过滤数据

#### 组合WHERE子句

- 操作符：`AND`，指定检索满足所有给定条件的行
- 操作符：`OR`，指定检索匹配任一条件的行；（需要注意：同时出现`AND`和`OR`操作符时，`AND`的优先级更高，因此需要善用圆括号对操作符进行明确分组）
- 操作符：`IN`，用来指定条件范围，范围中的每个条件都可以进行匹配，`IN`取一组由逗号分隔，括在圆括号中的合法值；（功能与`OR`操作符相当，但是执行速度更快，并且可以包含其他`SELECT`语句，能够更动态的建立`WHERE`子句）
- 操作符：`NOT`，否定跟在其后的任何条件，不单独使用，总是与其他操作符一起使用；

### 6、用通配符进行过滤

- 操作符：`LIKE`，为在搜索子句中使用通配符，必须使用`LIKE`操作符，`LIKE`指示DBMS，后面跟的搜索模式利用通配符匹配而不是简单的相等匹配；（从技术上来说，`LIKE`是谓词，而不是操作符）
  - 通配符：`%`，`%`表示任何字符出现任意次数（包括0次，但是不能匹配`NULL`）；
  - 通配符：`_`，下划线的用途与`%`一样，但是它只能匹配单个字符；
  - 通配符：`[]`，方括号通配符用来指定一个字符集，它必须匹配指定位置的**一个字符**；（可用^来否定，有的是！）
- 通配符搜索一般比其他搜索要耗费更多的时间，特别是通配符放在开始处，搜索是最慢的；

### 7、创建计算字段

- 拼接： 将值联结到一起（将一个值附加到另一个值）构成单个值，操作符可以用加号（`+`）或两个竖杠（`||`）表示；（MySQL中需要使用`Concat()`函数，将所有需要拼接的元素放在一个括号中，中间用逗号隔开）；
- 如果需要去掉返回字段中字符串右边的空格，可以用`RTRIM()`函数来完成（去掉左边空格用`LTRIM()`、去掉两边的空格用`TRIM() `）；
- SQL支持列别名，也就是一个字段或值的替换名，用`AS`关键字赋予；

### 8、使用函数处理数据

- 常用文本处理函数：

  |    函数     |          说明           |
  | :---------: | :---------------------: |
  |  `LEFT()`   |  返回字符串左边的字符   |
  |  `RIGHT()`  |  返回字符串右边的字符   |
  | `SOUNDEX()` | 返回字符串的`SOUNDEX`值 |
  | `LENGTH()`  |    返回字符串的长度     |
  |  `LTRIM()`  |  去掉字符串左边的空格   |
  |  `RTRIM()`  |  去掉字符串右边的空格   |
  |  `LOWER()`  |   将字符串转换为小写    |
  |  `UPPER()`  |   将字符串转换为大写    |

- 常用数值处理函数：

  |   函数   |        说明        |
  | :------: | :----------------: |
  | `ABS()`  | 返回一个数的绝对值 |
  | `COS()`  |  返回一个数的余弦  |
  | `EXP()`  | 返回一个数的指数值 |
  |  `PI()`  |     返回圆周率     |
  | `SIN()`  | 返回一个角度的正弦 |
  | `SORT()` | 返回一个数的平方根 |
  | `TAN()`  | 返回一个角度的正切 |

### 9、汇总数据

- 聚集函数：对某些行运行的函数，计算并返回一个值；
  - `AVG()`函数：通过对表中行数计数并计算其列值和，求得该列的平均值；可以用来返回所有列或特定列或特定行的平均值；`AVG()`函数只能用于单个列，而且列名必须作为函数参数给出，为获得多个列的平均值，必须使用多个`AVG()`函数；同时`AVG()`函数忽略列值为`NULL`的行；
  - `COUNT()`函数：进行计数，可用于确定表中行的数目或符合特定条件的行的数目；使用`COUNT(*)`对表中行的数目进行计数，不管表列中是否包含`NULL`；使用`COUNT(column)`对特定列中具有值的行进行计数，忽略`NULL`值；
  - `MAX()`函数：返回指定列名中的最大值；包括返回文本列中的最大值，对文本数据返回按该列排序后的最后一行，`MAX()`函数忽略列值为`NULL`的行；
  - `MIN()`函数：返回指定列名中的最小值；用于文本数据时，返回该列排序后最前面的行，忽略值为`NULL`的行；
  - `SUM()`函数：返回指定列值的和，忽略列值为`NULL`的行；
- 聚集不同值
  - 加入`DISTINCT`参数（只允许修饰列名）将使上述函数计算只包含不同的值；如果指定列名，`DISTINCT`只能用于`COUNT()`，不能用于`COUNT(*)`；

### 10、分组数据

- 分组是使用`SELECT`语句的`GROUP BY`子句建立的，`GROUP BY XX`子句指示DBMS按照`XX`来排序并且分组数据；使用了`GROUP BY`就不必指定要计算或估值的每个组了，系统会自动完成；

- `GROUP BY`子句可以包含任意数目的列，因而可以对分组进行嵌套，如果进行了嵌套分组，那么数据将在最后指定的分组上进行汇总；

- `GROUP BY`子句中列出的每一列都必须是检索列或有效的表达式，不能是聚集函数；

- 除聚集计算语句外，`SELECT`语句中的每一列都必须在`GROUP BY`子句中给出；

- `GROUP BY`子句必须出现在`WHERE`子句之后，`ORDER BY`子句之前；

- 过滤分组：`HAVING` 子句

  - `WHERE`过滤行，而`HAVING`过滤分组，`HAVING`支持所有`WHERE`操作符；
  - 差别：`WHERE`在数据分组前进行过滤，`HAVING`在数据分组后进行过滤；`WHERE`排除的行不包括在分组中，这可能会改变计算值，从而影响`HAVING`子句中基于这些值过滤掉的分组；

- 分组与排序：`GROUP BY` & `ORDER BY`

  - `ORDER BY`：对产生的输出排序，任意列都可以使用，甚至分选择的列也可以使用；
  - `GROUP BY`：对行分组，但是输出可能不是分组的顺序，只可能使用选择列或表达式列，而且必须使用每个选择列表达式；
  - 一般在使用`GROUP BY`子句时，应该也给出`ORDER BY`子句，这是保证数据正确排序的唯一方法，千万不要仅依赖`GROUP BY`排序数据；

- `SELECT`子句顺序：（如果使用）

  `SELECT->FROM->WHERE->GROUP BY->HAVING->ORDER BY`

### 11、使用子查询

- 利用`IN`子句，可以嵌套`SELECT`查询语句，并且子查询总是从内向外处理；
- 对于能嵌套的子查询的数目没有限制，但嵌套太多子查询将导致性能降低；
- 作为子查询的`SELECT`语句只能查询单个列；
- 完全限定列名，它指定表名和列名；

### 12、联结表

- `SQL`最强大的功能之一就是能在数据查询的执行中联结表，相同的数据出现多次不是好事，关系表的设计就是要把信息分解成多个表，一类数据一个表，各表通过某些共同的值互相关联，所以才叫关系数据库；
- 每个表应该具有唯一的标识，这个标识称为主键；
- 联结是一种机制，用来在一条`SELECT`语句中关联表，因此称为联结，使用特殊的语法，可以联结多个表返回一组输出，联结在运行时关联表中正确的行；
- 例如：利用`where`子句联结，`WHERE Vendors.vend_id = Products.vend_id`;要用完全限定列名；
- 在一条SELECT语句中联结几个表时，相应的关系是在运行中构造的；
- 以上称为等值联结，也称为内联结，它基于**两个**表之间的相等测试；可以用另一种语法，`FROM table1 INNER JOIN table2 ON table1.xx = table2. xx`；

### 13、创建高级联结

